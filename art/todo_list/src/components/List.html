<script>
    export let tasks;
    export let category;
    export let giphy;

    import { createEventDispatcher } from 'svelte';
    import { fly } from 'svelte/transition';;
    
    const dispatch = createEventDispatcher();

    $: array = tasks.filter(t => t.category == category)

    const test = () => {
        console.log(tasks);
        console.log(category)
    }

    const deleteTask = (todo) => {
        dispatch('delete', {
            task: todo
        })
    }

    let gif = giphy


    const handleChangeHour = (todo) => {
        
        const now = new Date();
			const h = now.getHours();
			const m = now.getMinutes();
			const s = now.getSeconds();
			const hour = `${h}:${m}:${s}`
        todo.date = hour
    
    }

</script>



<style>
    .categorie{
        
        background-image:url({gif});
        background-repeat: no-repeat;
        background-size: 100%;
        background-position: center;
        height: 50vh;
        width: 300px;
        border-radius: 50%
    
    }

    h2{

        font-size: 4em;
        color: #1B9AAA;

    }

    .list{

        background-color: #F5F1E3;

    }
    
</style>

<div class="mt-12 container m-4 rounded-md list shadow-md " transition:fly="{{ y: 200, duration: 2000 }}">
    
    
    <h2 class="text-center font-mono">{category}</h2>
    
    <div class="categorie m-auto mb-12" style="background-image:url({gif})"></div>
    
    <div class="text-center">
        <ul transition:fly="{{ y: 200, duration: 2000 }}">
            {#each array as task}
            <li class="pb-4" transition:fly="{{ y: -200, duration: 500 }}">
                <input type="checkbox" bind:checked={task.completed} on:click={() => {handleChangeHour(task)}}>
                {#if !task.completed}
                    <div class="text-red-600" >
                        <p>* {task.todo} * </p>                           
                        <p>add task at: {task.date}</p> 
                    </div>
                {:else}
                    <div class="text-green-600">
                        <p>* {task.todo} * </p>     
                        <p>do since: {task.date}</p> 
                    </div>
                {/if}
                <span><button on:click|preventDefault={() => deleteTask(task)}>supprimer</button></span>
            </li>
            {/each}
        </ul>   
    </div>
</div>

<!-- {JSON.stringify(array)} -->